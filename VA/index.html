<body>
<script>
	const commands = {
		'hora': t => speechSynthesis.speak(new SpeechSynthesisUtterance(new Date().toLocaleString('en', {hour: 'numeric', minute: 'numeric', hour12: true}))),
		'temperatura': t => navigator.geolocation.getCurrentPosition(e => fetch(`https://api.open-meteo.com/v1/meteofrance?latitude=${e.coords.latitude}&longitude=${e.coords.longitude}&current=temperature`).then(r => r.json()).then(r => speechSynthesis.speak(new SpeechSynthesisUtterance(`${Math.round(r.current.temperature)} ${r.current_units.temperature}`))))
	}

	SpeechRecognition = window.webkitSpeechRecognition || window.SpeechRecognition

	document.body.appendChild(Object.assign(document.createElement('button'), {
		innerHTML: 'Start',
		onclick() {
			speechSynthesis.speak(new SpeechSynthesisUtterance('Hola'))

			Object.assign(new SpeechRecognition, {
				continuous: true,
				lang: 'es-ES',
				onresult: e => commands[e.results[e.results.length - 1][0].transcript.normalize('NFD').replace(/\p{Diacritic}/gu, '').toLowerCase().trim()]?.(),
				onend() {
					this.start()
				}
			}).start()

			this.remove()
		}
	}))
</script>
</body>
